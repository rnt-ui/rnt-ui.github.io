# トップアップ（Top Up／TU）— 詳細仕様

## 0. 位置づけと目的

- トップアップは各サイクルにつき一度だけ行う**音から味への介入**である。
    
- 目的は、仕込みで作った状態に対して**必要最小限の追加入れ**と**対応ノブの微調整（±1クリック＝±1/5）**を行い、現在の音タグ（刺／無／だ）に対する**最小刻みの補正**を与えることにある。
    
- トップアップは**方向表（T0／T1／T2）に依存しない**（T非依存）。向きの決定は下記の優先と端ノブ回避の規則に従う。
    

## 1. 物理量とノブの扱い

- **投入量（目安）**
    
    - 液体（焼酎・美酢・炭酸）：10〜20 ml
        
    - 固形（氷・レモン）：1〜2 個（レモンは**個**で数える）
        
- **ノブ操作**
    
    - 対象とした素材に対応するノブを**±1クリック（=±1/5）だけ**回す。
        
    - **端ノブ回避**：在位が**0/5 または 5/5**のノブは**選ばない**（ただし**+1クリックで端に到達することは許可**）。
        
    - **方向の取り方**：
        
        - **タグ＝無**のときだけ**焼酎（VARI）を優先し、時計回りを優先**（もし時計回りが端在位で不可能なら反時計回り）。
            
        - **タグ＝刺／だ**のときは、下記の**素材優先順位**で対象を選び、**最小の補正意図に合う向き**（時計回りまたは反時計回り）を**±1クリック**だけ与える（固定方向は持たない／端在位は選ばない）。
            

> **注記：トップアップも「残骸」は加算する**。

## 2. 候補の選び方（優先順位）

現在の音タグを確認し、下の優先順位に従って**選べるノブ（＝端在位でないノブ）**を一つだけ選ぶ。

- **刺** → **氷（FALL）** → **美酢（OT）**
    
- **だ** → **レモン（RISE）** → **炭酸（MULTI）**
    
- **無** → **焼酎（VARI）**（**時計回り優先／不可なら反時計回り**）
    

> 端ノブ回避のため**在位が0/5・5/5の候補は飛ばす**。ただし**+1クリックで端に“到達する”のは可**（= 現在在位が端でないことが条件）。

## 3. 空振りトップアップ（どうしても選べない場合）

- すべての候補が**端在位**で選べない場合は、**空振りトップアップを許可**する。
    
- **空振りトップアップ**：**素材は所定量だけ実際に追加**するが、**ノブは一切回さない**（ノブ不変）。
    
- 空振りトップアップを行った場合でも、**残骸は加算しない**（トップアップ起因の残骸加算は常になし）。
    

## 4. 手順（簡潔フロー）

1. **音タグ**（刺／無／だ）を確認する。
    
2. **優先順位**に従って候補素材を走査し、**端在位でないノブ**を一つだけ選ぶ。
    
3. **量**を決める（液体 10〜20 ml／固形 1〜2 個）。
    
4. **±1クリック**だけ回す（**端在位は選ばない／+1クリックで端到達は可**）。
    
    - タグ＝無のときは**焼酎を時計回り優先**（不可なら反時計回り）。
        
    - タグ＝刺／だのときは**最小補正になる向き**を演奏者が選ぶ（±1クリックのみ）。
        
5. 全候補が端在位で選べない場合は**空振りトップアップ**（素材だけ追加／ノブは不変）。
    
6. **記録**する（ログは略語体で可。残骸加算はしないため記録対象外）。
    

## 5. 例外（SPILL）

- トップアップの**投入で実際に物理的に溢れた**場合は、その時点で**SPILLイベント**へ移行する（中断 → T3＋ALL＋+1/5 → 刺固定で飲む→テイストフィックス → 残骸を0に→休憩1分→次サイクル初期化）。
    
- SPILL時の詳細はSPILL章に従う。
    

---

## ログ

### 凡例（ログ内）

- **TU**＝トップアップ
    
- **VARI／OT／MULTI／RISE／FALL**＝焼酎／美酢／炭酸／レモン／氷
    
- **CW／CCW**＝時計回り／反時計回り
    
- **空振り**＝素材のみ追加／ノブ不変
    
- **（注）TUでは残骸を付記しない**（仕込みのみ加算）
    

### 記入例

1. タグ＝刺（第1候補が使えた例）  
    `TU → RISE_CCW(+1/5)`
    
2. タグ＝刺（第1候補が端在位で不可→第2候補へ）  
    `TU → MULTI_CW(+1/5)`
    
3. タグ＝だ（第2候補を採用）  
    `TU → OT_CW(+1/5)`
    
4. タグ＝無（規定の方向優先：焼酎はCW優先）  
    `TU → VARI_CW(10ml)`
    
5. タグ＝無（CWが端在位→CCWで最小）  
    `TU → VARI_CCW(+1/5)`
    
6. すべて端在位で**空振り**（素材は入れ、ノブは回さない）  
    `TU → 空振り（素材のみ投入）`
    
7. トップアップで**物理的に溢れた**（SPILL移行を明示）  
    `TU → MULTI_CW(+1/5) ★SPILL`
    

> 方向（CW／CCW）は、**タグ＝無のVARIのみルールで規定**。それ以外（刺／だ）のときは**最小補正としての±1クリック**を**その都度選んで記録**する。
