# ステア（FM変調／Stir）— 詳細仕様

## 0. 位置づけと目的

- ステアは各サイクルで実行する**味と音の攪拌・変調操作**である。
    
- 目的は、味側の操作（仕込み／トップアップ／テイストフィックス）に対して、**最小刻み（クリック単位）で音の揺れ（FM深さ）を与える**こと。
    
- ステアは**方向表（T0／T1／T2）に依存しないが、回数はTに依存**する（下記1-2）。
    
- ステアは**一方向に一度だけ回す**。**往復**や**方向の切り替え**、**跨いでの回転**は行わない。
    

## 1. パラメータと状態

### 1-1. FM位置と深さ

- **初期位置**：12時位置（= **FM深さ0**）。
    
- **FM深さ**：0〜5 の**クリック数**で管理する（0＝無変調、5＝最大）。
    
- **端到達**：12時から**左（反時計回り）**に回す場合は 0→1→…→5、**右（時計回り）**に回す場合も同様に**深さを“クリック数”で積算**し、**端（5）に達したらそこまで**とする（**超えない**／**跨がない**）。
    

### 1-2. 1サイクルの回数（T依存）

- **T0＝1回**、**T1＝2回**、**T2＝3回**。
    
- 1回＝**FM深さを1クリック加える**ことを意味する。したがって、例えばT2なら**同一方向に3クリック進める**。
    

### 1-3. 方向（左／右）

- そのサイクルの**ステア方向（左／右）はサイクル内で固定**する（**途中で反転しない**）。
    
- **通常時の方向選択は演奏者の裁量**（味側の判断と連動するが、方向表には依存しない）。
    
- **SPILL直後の“次サイクルだけ”**、**初手のステア方向**は**「T × SeedTag(next)」**で与える（SPILLの規定、下記3-2）。
    

## 2. 減衰（休憩）と特例

### 2-1. 通常の減衰

- 各サイクルの最後の**休憩（1分）**で、**FM深さを 1 クリック減衰**させる（**0未満にはならない**）。
    

### 2-2. T0連続時の特例（保持）

- **T0が連続した場合**、**2回目以降**の休憩では**減衰を適用しない（=保持）**とする。
    
- これにより、**飲むほどに酔いが蓄積 → 音の揺れが残留**する効果を担保する。
    
- 連続が途切れたら、次のサイクルからは**通常の減衰（-1 クリック）**に戻す。
    

## 3. SPILLとの関係

### 3-1. サイクル内でSPILLが発生した場合

- SPILLは**仕込み**または**トップアップ**で**物理的に溢れたときのみ**発生する。
    
- **発生時点で以降の通常進行を中断**し、SPILL手順に入る（T3＋ALL＋+1/5、音タグ=刺固定で飲む→テイストフィックス→残骸を0に→休憩1分）。
    
- 当該サイクルのステアは、**SPILL以降は行わない**（すでに行っていた分のFM深さは、その後のSPILL手順に上書きされる運用でよい。厳密な破棄／維持は演奏ログに注記して可）。
    

### 3-2. SPILL直後の次サイクル（初期化）

- **次サイクルの冒頭**で：
    
    - **Tを再抽選**する。
        
    - **FM位置を12時にリセット（FM深さ0）**する。
        
    - **ステア回数は1回固定**（この**“次サイクルだけ” 例外**）。
        
    - **初手のステア方向**は**「T × SeedTag(next)」**で与える（SeedTag(next)はSPILL中のテイストフィックスで判定されたタグ）。
        
- 以後のサイクルはふたたび通常規則（1-2、2-1、2-2）に従う。
    

## 4. 手順（時系列）

1. **FMの現在位置（12時基準）**と**FM深さ**を確認する。
    
2. そのサイクルの**Tに応じた回数（1／2／3）**を決定する。
    
3. **方向（左／右）**を**一つだけ**選ぶ（SPILL直後の次サイクルのみ「T × SeedTag(next)」）。
    
4. **選んだ方向に、回数ぶんのクリック数だけ**回す（端到達で停止、跨がない）。
    
5. サイクル末尾の**休憩**で**減衰**を適用（通常は**-1クリック**、**T0連続時の2回目以降は保持**）。
    
6. **FM深さ（0〜5）**は**サイクルを越えて持ち越す**（SPILL直後の次サイクルだけ 3-2 の初期化）。
    

## 5. 記録の基本方針

- **FM深さ**と**方向（左／右）**、実行**回数**、**休憩時の減衰または保持**を**毎サイクル記録**する。
    
- SPILLが発生した場合は、**ステアの行（有無）を明示**し、**SPILL手順の記録**に続ける。
    
- 方向はログでは**「左／右」**表記でよい（CW/CCWに換算しても可）。
    
- 端で止めた場合は**「端到達」**と付記すると後から追いやすい。
    

---

# ログ（略語あり）— 記入例

### 凡例（ログ内）

- **Stir=数字**：そのサイクルで**加えたクリック数**（= T由来の回数）
    
- **FM深さ=数字（左／右）**：サイクル終了時点のFM深さと方向
    
- **Rest=-1**：休憩で**-1クリック減衰**
    
- **Rest=保持**：T0連続の**保持特例**を適用（減衰なし）
    
- **端到達**：回転中に端（5）で停止
    
- **★SPILL**：当サイクルでSPILLイベント発生
    
- **次サイクル**：SPILL直後サイクルの初期化メモ
    

### 記入例

1. **通常（T1=2回／左）**  
    `Stir=2 / FM深さ=2（左） / Rest=-1 → FM深さ=1（左）`
    
2. **T2=3回／右、端で止まる**  
    `Stir=3 / FM深さ=5（右／端到達） / Rest=-1 → FM深さ=4（右）`
    
3. **T0が連続（2回目）：保持特例**  
    `Stir=1 / FM深さ=2（左） / Rest=保持（T0連続） → FM深さ=2（左）`
    
4. **SPILLがサイクル途中で発生（以降のステア中断）**  
    `Stir=1 / FM深さ=1（右） ★SPILL → （以降はSPILL手順ログへ）`
    
5. **SPILL直後の次サイクル（初期化・方向はT×SeedTag(next)）**  
    `次サイクル: T=再抽選 / FM=12時 / Stir=1固定 / 初手方向= T×SeedTag(next)`
    
6. **端近で1クリックのみ加えて端到達**  
    `Stir=1 / FM深さ=5（左／端到達） / Rest=-1 → FM深さ=4（左）`
