# UI SOUR｜ルール（R8 v0.99）

## 素材レンジ & ノブ
- **素材**：焼酎／美酢／炭酸＝10–50ml、レモン／氷＝1–5（段＝±1/5）  
- **ノブ**：各 0–5（整数）  
  - 対応：VARI=焼、OT=美、MULTI=炭、RISE=レ、FALL=氷  

---

## 方向表・タグ
- 方向表 T0 / T1 / T2  
- タグ：刺／無／だ（平板→無）  
- 仕込み時は **T ×（その時点のタグ）** で向きを決定  

---

## 仕込み（Ø改訂）
- 手順：素材 → ノブ（入れた量＝クリック数）  
- 端ロック：5/5でCW、0/5でCCW → Ø（投入もクリックも無し）  
- 部分許容：規定クリックに満たなくても **端までの最小分（最低+1/5）**だけ入れる  
- ガード：Øは1サイクル最大2枠／同一素材の連続Ø禁止  
- 残骸RS（氷個数／レモンしぼり数）：仕込みで入れた分のみ蓄積（TUは加算しない）  

---

## TU（トップアップ｜T非依存・優先表）
- 各サイクル1回  
- 量：液体10–20ml／固形1–2個／レモン1–2しぼり  
- 優先順：  
  - 刺：RISE → MULTI → FALL  
  - だ：RISE → OT → MULTI  
  - 無：VARI（CW優先／不可＝端在位ならCCW）  
- 端ノブ回避：端在位（0/5, 5/5）は選ばない（+1で端到達は可）  
- 全候補不可なら **空振りTU 可**（素材は入れる／ノブ不変）  

---

## TF（テイストフィックス｜T非依存・優先表）
- 各サイクル1回・1本だけ／±1/5  
- 優先順・端ノブ回避は TU と同じ  
- Order更新：TF の「対象 × 向き」で次サイクルの並びを回転  

---

## ステア（FM）
- 回数＝T0=1／T1=2／T2=3（SPILL明けの次サイクルのみ1回固定）  
- 初期位置 12時、一方向に一度だけ回す（往復・跨ぎ無し）  
- 休憩で −1クリック減衰  
- **T0特例（新規）**：T0が連続した場合、2回目以降は減衰を適用しない（保持）  
- 記録例：Rest=保持(T0連続→酔蓄積)  

---

## SPILL（物理溢れのみ）
- 仕込み or TU で実際に溢れたら発生  
- イベント手順：  
  1. 中断 → T3＋ALL+1/5 → 音タグ=刺固定  
  2. 飲む（通常どおり TF を含む）→ Order 即時更新／SeedTag(next)=TF判定タグ  
  3. RS=0（氷・レモン片を除去）  
  4. 休憩1分  
- 次サイクル初期：T再抽選／FM=12時／ステア=1回／Order=更新後  
  - 初手の向き＝T × SeedTag(next)  

---

## 進行（1サイクル要約）
仕込み（Ø・部分許容／RS加算）  
→ 聴取  
→ TU×1（優先表・端回避・空振り可）  
→ 聴取  
→ ステア（T準拠）  
→ 飲む  
→ TF（±1/5・Order更新）  
→ 休憩1分（FM−1／T0連続なら保持）  

※どこかで実溢れしたら即 SPILL へ  

---

## 進行基準の明示（累積ずれ）
- サイクル進行は常に **直前サイクルの Order／ノブ配置** を基準とする  
- TF による回転・逆転は **位相ずれを累積**させる（仕様）  

---

## 迷ったときの最短手順
- 仕込みで端に当たる：Ø（可動余地ゼロ）／部分許容（端まで+1/5）  
- TU/TF（刺）：まず レモン最小、不可なら 炭酸、それも不可なら 氷  
- TU/TF（だ）：まず レモン最小、不可なら 美酢、それも不可なら 炭酸  
- TU/TF（無）：焼酎10ml（CW不可＝端在位ならCCW）  
- 端在位は選ばない（到達は可）。TUは空振り可  
- T0が連続したら 減衰せず保持（酔蓄積）  

---

## 次スレ開始チェックリスト
- Aim 一行共有（例：「散逸→収束」）  
- **T（方向表）**をダイス等で決定・宣言  
- Order 初期並びを宣言（標準均衡／上昇先行／収束先行など）  
- ノブ初期：先頭素材のみ 7時=0、他 12時  
- RS=0で開始（氷・レモン片なし）  
- ログ書式の確認（Ø／部分／空振り／SPILL／保持表記）  

---

## ログ書式（最小）
- 仕込み：`V2/O1/M+1/5(部分)/RØ/F2 → <タグ>`  
- TU：`TU → RISE_CCW(+1/5)`（優先表・端回避）  
- ステア：`Stir=2 / FM深さ=2（左）`  
- 飲む→TF：`TF=OT_CW(+1/5) → NextOrder ← TF(OT,CW)`  
- SPILL：`★SP（T3＋ALL+1/5／刺固定）→ 飲む+TF → RS=0 → 休憩1分`  
- T0連続保持：`Rest=保持(T0連続→酔蓄積)`  

---

## 記録補助（任意）
- **酔い度（主観／簡易数値）**をログ末尾に併記可  
- ルール演算には未反映（今後検討）  

例：`酔度=2/5`  

---

**以上が現行ルール（R8 v0.99）である。**
